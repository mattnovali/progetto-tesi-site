(function(){"use strict";var e={6406:function(e,t,o){var n=o(5130),i=o(6768);function r(e,t,o,n,r,s){const a=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.Wv)(a)}var s={data(){return{wakeLock:null}},async mounted(){if("wakeLock"in navigator)try{this.wakeLock=await navigator.wakeLock.request("screen")}catch(e){console.warn("Wake Lock non disponibile:",e)}},beforeUnmount(){this.wakeLock&&this.wakeLock.release&&this.wakeLock.release()}},a=o(1241);const l=(0,a.A)(s,[["render",r]]);var d=l,c=o(4458);(0,c.k)("/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var u=o(1387);const h={class:"home"};function p(e,t,o,n,r,s){return(0,i.uX)(),(0,i.CE)("div",h,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>s.triggerCamera&&s.triggerCamera(...e))},"Record Video"),(0,i.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>s.triggerVideoSelection&&s.triggerVideoSelection(...e))},"Analyze Video"),t[4]||(t[4]=(0,i.Lk)("button",null,"Real Time Analyzer",-1)),t[5]||(t[5]=(0,i.Lk)("button",null,"Track",-1)),(0,i.Lk)("input",{ref:"cameraInput",type:"file",accept:"video/*",capture:"environment",style:{display:"none"},onChange:t[2]||(t[2]=(...e)=>s.handleVideoSelected&&s.handleVideoSelected(...e))},null,544),(0,i.Lk)("input",{ref:"videoInput",type:"file",accept:"video/*",style:{display:"none"},onChange:t[3]||(t[3]=(...e)=>s.handleVideoSelected&&s.handleVideoSelected(...e))},null,544)])}o(4114);var m={name:"HomeView",components:{},methods:{triggerCamera(){this.$refs.cameraInput.click()},triggerVideoSelection(){this.$refs.videoInput.click()},handleVideoSelected(e){const t=e.target,o=t.files[0],n=["video/mp4","video/webm","video/ogg"];if(t.value="",o){if(!n.includes(o.type))return void alert(`Formato non supportato: ${o.type||"sconosciuto"}.\nFormati consentiti: ${n.join(", ")}`);const e=URL.createObjectURL(o);this.$router.push({name:"selected-video",query:{videoUrl:e}})}}},mounted(){this.$refs.videoInput&&(this.$refs.videoInput.value="")}};const v=(0,a.A)(m,[["render",p],["__scopeId","data-v-b7c94200"]]);var f=v,k=o(4232);const g={class:"selected-video-view"},y=["src"],w={key:1,class:"progress-container"},b=["value"],L={class:"navigation-buttons"};function C(e,t,o,r,s,a){return(0,i.uX)(),(0,i.CE)("div",g,[(0,i.Lk)("label",null,[t[6]||(t[6]=(0,i.eW)("Model: ")),(0,i.bo)((0,i.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.selectedModel=e)},t[5]||(t[5]=[(0,i.Lk)("option",{value:"pose_landmarker_full.task"},"Full",-1),(0,i.Lk)("option",{value:"pose_landmarker_heavy.task"},"Heavy",-1),(0,i.Lk)("option",{value:"pose_landmarker_lite.task"},"Lite",-1)]),512),[[n.u1,s.selectedModel]])]),s.videoUrl?((0,i.uX)(),(0,i.CE)("video",{src:s.videoUrl,controls:"",autoplay:"",loop:"",key:s.videoUrl},null,8,y)):(0,i.Q3)("",!0),s.analyzing?((0,i.uX)(),(0,i.CE)("div",w,[(0,i.Lk)("label",null,"Analisi in corso: "+(0,k.v_)(s.analysisProgress)+"%",1),(0,i.Lk)("progress",{value:s.analysisProgress,max:"100"},null,8,b)])):(0,i.Q3)("",!0),(0,i.Lk)("div",L,[(0,i.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.goBack&&a.goBack(...e))},"Back"),(0,i.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>a.triggerVideoSelection&&a.triggerVideoSelection(...e))},"Change Video"),(0,i.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>a.analyzeAndGoToResults&&a.analyzeAndGoToResults(...e))},"Analyze")]),(0,i.Lk)("input",{ref:"videoInput",type:"file",accept:"video/*",style:{display:"none"},onChange:t[4]||(t[4]=(...e)=>a.handleVideoSelected&&a.handleVideoSelected(...e))},null,544)])}var U=o(485),V={name:"SelectedVideoView",data(){return{videoUrl:this.$route.query.videoUrl||null,analyzing:!1,analysisProgress:0,selectedModel:"pose_landmarker_heavy.task",landmarkerInstance:null,videoElement:null}},methods:{triggerVideoSelection(){this.$refs.videoInput&&(this.$refs.videoInput.value="",this.$nextTick((()=>{this.$refs.videoInput.click()})))},handleVideoSelected(e){const t=e.target.files[0],o=["video/mp4","video/webm","video/ogg"];if(t){if(!o.includes(t.type))return void alert(`Unsupported video format: ${t.type||"unknown"}.\nSupported formats: ${o.join(", ")}`);this.videoUrl&&URL.revokeObjectURL(this.videoUrl);const e=URL.createObjectURL(t);this.videoUrl=e}},goBack(){this.$router.go(-1)},async analyzeAndGoToResults(){if(!this.videoUrl)return void alert("Select a video first.");try{await fetch("https://www.google.com",{mode:"no-cors"})}catch(t){return void alert("You are offline")}this.analyzing=!0;const e=await this.analyzeVideo(this.videoUrl);this.analyzing=!1,this.$router.push({name:"analysis-results",state:{results:e,videoUrl:this.videoUrl}})},async analyzeVideo(e){const t=await U.Ps.forVisionTasks("https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@latest/wasm"),o=await U.Pi.createFromOptions(t,{baseOptions:{modelAssetPath:`/models/${this.selectedModel}`,delegate:"GPU"},runningMode:"VIDEO",numPoses:1});return this.landmarkerInstance=o,new Promise((t=>{const n=document.createElement("video");n.src=e,n.crossOrigin="anonymous",n.muted=!0,n.playsInline=!0,n.autoplay=!1,n.loop=!1,n.style.display="none",document.body.appendChild(n),this.videoElement=n;const i=[],r=10;n.onloadedmetadata=async()=>{n.currentTime=0,n.play();const e=n.duration;let s=0;const a=async()=>{if(s>e)return n.pause(),document.body.removeChild(n),void t(i);n.currentTime=s,await new Promise((e=>n.onseeked=e));const l=o.detectForVideo(n,1e3*s);i.push({time:s,poses:l}),console.log(`Frame @ ${s.toFixed(2)}s:`,l),console.log("Using model:",this.selectedModel),this.analysisProgress=Math.min(100,Math.round(s/e*100)),s+=1/r,setTimeout(a,0)};a()}}))}},beforeUnmount(){this.landmarkerInstance&&this.landmarkerInstance.close&&(this.landmarkerInstance.close(),this.landmarkerInstance=null),this.videoElement&&this.videoElement.parentNode&&(this.videoElement.pause(),this.videoElement.parentNode.removeChild(this.videoElement),this.videoElement=null),this.videoUrl=null}};const E=(0,a.A)(V,[["render",C],["__scopeId","data-v-0231d938"]]);var $=E;const I={style:{position:"relative",display:"inline-block"}},S=["src"],x={ref:"canvas",style:{position:"absolute",left:"0",top:"0","pointer-events":"none"}},_={style:{"margin-top":"1em"}},R={style:{"margin-left":"1em"}},A={style:{"margin-left":"2em"}},F={style:{"margin-left":"1em"}};function M(e,t,o,r,s,a){return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.goBack&&a.goBack(...e))},"Back"),(0,i.Lk)("div",null,[(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>s.showLandmarks=e)},null,512),[[n.lH,s.showLandmarks]]),(0,i.eW)(" "+(0,k.v_)(s.showLandmarks?"Nascondi landmark":"Mostra landmark"),1)]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>s.showConnections=e)},null,512),[[n.lH,s.showConnections]]),(0,i.eW)(" "+(0,k.v_)(s.showConnections?"Nascondi connessioni":"Mostra connessioni"),1)]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>s.showLeft=e)},null,512),[[n.lH,s.showLeft]]),(0,i.eW)(" "+(0,k.v_)(s.showLeft?"Nascondi sinistra":"Mostra sinistra"),1)]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>s.showRight=e)},null,512),[[n.lH,s.showRight]]),(0,i.eW)(" "+(0,k.v_)(s.showRight?"Nascondi destra":"Mostra destra"),1)]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=e=>s.showUpper=e)},null,512),[[n.lH,s.showUpper]]),(0,i.eW)(" "+(0,k.v_)(s.showUpper?"Nascondi parte sopra":"Mostra parte sopra"),1)]),(0,i.Lk)("label",null,[(0,i.bo)((0,i.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=e=>s.showLower=e)},null,512),[[n.lH,s.showLower]]),(0,i.eW)(" "+(0,k.v_)(s.showLower?"Nascondi parte sotto":"Mostra parte sotto"),1)])]),(0,i.Lk)("div",I,[(0,i.Lk)("video",{ref:"video",src:s.videoUrl,controls:"",loop:"",style:{"max-width":"100%","max-height":"50vh"}},null,8,S),(0,i.Lk)("canvas",x,null,512)]),(0,i.Lk)("div",_,[(0,i.Lk)("label",null,[t[11]||(t[11]=(0,i.eW)(" Colore linee: ")),(0,i.bo)((0,i.Lk)("input",{type:"color","onUpdate:modelValue":t[7]||(t[7]=e=>s.lineColor=e)},null,512),[[n.Jo,s.lineColor]])]),(0,i.Lk)("label",R,[t[12]||(t[12]=(0,i.eW)(" Spessore linee: ")),(0,i.bo)((0,i.Lk)("input",{type:"number","onUpdate:modelValue":t[8]||(t[8]=e=>s.lineWidth=e),min:"1",max:"10",style:{width:"50px"}},null,512),[[n.Jo,s.lineWidth,void 0,{number:!0}]])]),(0,i.Lk)("label",A,[t[13]||(t[13]=(0,i.eW)(" Colore punti: ")),(0,i.bo)((0,i.Lk)("input",{type:"color","onUpdate:modelValue":t[9]||(t[9]=e=>s.pointColor=e)},null,512),[[n.Jo,s.pointColor]])]),(0,i.Lk)("label",F,[t[14]||(t[14]=(0,i.eW)(" Spessore punti: ")),(0,i.bo)((0,i.Lk)("input",{type:"number","onUpdate:modelValue":t[10]||(t[10]=e=>s.pointRadius=e),min:"1",max:"20",style:{width:"50px"}},null,512),[[n.Jo,s.pointRadius,void 0,{number:!0}]])])])],64)}o(8111),o(7588);var O={name:"MediaPipeResultsView",data(){return{results:history.state?.results||[],videoUrl:history.state?.videoUrl||null,currentFrame:null,animationFrameId:null,showLeft:!0,showRight:!0,showUpper:!0,showLower:!0,showLandmarks:!0,showConnections:!0,lineColor:"#0000ff",lineWidth:2,pointColor:"#ff0000",pointRadius:4}},mounted(){this.$refs.video.addEventListener("loadedmetadata",this.resizeCanvas),window.addEventListener("resize",this.resizeCanvas),this.$refs.video.addEventListener("play",this.startDrawing),this.$refs.video.addEventListener("pause",this.stopDrawing),this.$refs.video.addEventListener("ended",this.stopDrawing),this.$refs.video.addEventListener("timeupdate",this.drawLandmarks)},beforeUnmount(){window.removeEventListener("resize",this.resizeCanvas),this.stopDrawing(),this.$refs.video.removeEventListener("timeupdate",this.drawLandmarks)},methods:{goBack(){this.$router.back()},resizeCanvas(){const e=this.$refs.video,t=this.$refs.canvas;t.width=e.clientWidth,t.height=e.clientHeight,t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px"},startDrawing(){if(this.animationFrameId)return;const e=()=>{this.drawLandmarks(),this.animationFrameId=requestAnimationFrame(e)};e()},stopDrawing(){this.animationFrameId&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)},drawLandmarks(){const e=this.$refs.video,t=this.$refs.canvas;if(!t||!e)return;this.resizeCanvas();const o=e.currentTime;let n=null,i=1/0;for(const m of this.results){const e=Math.abs(m.time-o);e<i&&(i=e,n=m)}const r=t.getContext("2d");if(r.clearRect(0,0,t.width,t.height),!n||!n.poses?.landmarks?.length)return;const s=t.width,a=t.height,l=[11,13,15,17,19,21,23,25,27,29,31],d=[12,14,16,18,20,22,24,26,28,30,32],c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24],u=[23,24,25,26,27,28,29,30,31,32],h=[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[27,29],[29,31],[26,28],[28,30],[30,32]],p=e=>{const t=this.showLeft&&l.includes(e)||this.showRight&&d.includes(e),o=this.showUpper&&c.includes(e)||this.showLower&&u.includes(e);return t&&o};if(this.showConnections){r.strokeStyle=this.lineColor,r.lineWidth=this.lineWidth;for(const e of n.poses.landmarks)for(const[t,o]of h)e[t]&&e[o]&&p(t)&&p(o)&&(r.beginPath(),r.moveTo(e[t].x*s,e[t].y*a),r.lineTo(e[o].x*s,e[o].y*a),r.stroke())}if(this.showLandmarks){r.fillStyle=this.pointColor;for(const e of n.poses.landmarks)e.forEach(((e,t)=>{if(p(t)){const t=e.x*s,o=e.y*a;r.beginPath(),r.arc(t,o,this.pointRadius,0,2*Math.PI),r.fill()}}))}}}};const P=(0,a.A)(O,[["render",M]]);var T=P;const W=[{path:"/",name:"home",component:f},{path:"/selected-video",name:"selected-video",component:$},{path:"/analysis-results",name:"analysis-results",component:T},{path:"/about",name:"about",component:()=>o.e(594).then(o.bind(o,603))}],j=(0,u.aE)({history:(0,u.Bt)(),routes:W});var z=j;(0,n.Ef)(d).use(z).mount("#app")}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}o.m=e,function(){var e=[];o.O=function(t,n,i,r){if(!n){var s=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],r=e[c][2];for(var a=!0,l=0;l<n.length;l++)(!1&r||s>=r)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(a=!1,r<s&&(s=r));if(a){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[n,i,r]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.f={},o.e=function(e){return Promise.all(Object.keys(o.f).reduce((function(t,n){return o.f[n](e,t),t}),[]))}}(),function(){o.u=function(e){return"js/about.4f456a52.js"}}(),function(){o.miniCssF=function(e){}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="progetto-tesi:";o.l=function(n,i,r,s){if(e[n])e[n].push(i);else{var a,l;if(void 0!==r)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+r){a=u;break}}a||(l=!0,a=document.createElement("script"),a.charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",t+r),a.src=n),e[n]=[i];var h=function(t,o){a.onerror=a.onload=null,clearTimeout(p);var i=e[n];if(delete e[n],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((function(e){return e(o)})),t)return t(o)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),l&&document.head.appendChild(a)}}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){o.p="/"}(),function(){var e={524:0};o.f.j=function(t,n){var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((function(o,n){i=e[t]=[o,n]}));n.push(i[2]=r);var s=o.p+o.u(t),a=new Error,l=function(n){if(o.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),s=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",a.name="ChunkLoadError",a.type=r,a.request=s,i[1](a)}};o.l(s,l,"chunk-"+t,t)}},o.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,r,s=n[0],a=n[1],l=n[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);if(l)var c=l(o)}for(t&&t(n);d<s.length;d++)r=s[d],o.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return o.O(c)},n=self["webpackChunkprogetto_tesi"]=self["webpackChunkprogetto_tesi"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(6406)}));n=o.O(n)})();
//# sourceMappingURL=app.2be413fe.js.map